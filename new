; simple_loader.ahk
#NoEnv

; Load the DLL
hModule := DllCall("LoadLibrary", "Str", "test_dll.dll")

if (hModule) {
    ; Call OpenCalculator
    funcCalc := DllCall("GetProcAddress", "Ptr", hModule, "AStr", "OpenCalculator")
    if (funcCalc) {
        DllCall(funcCalc)
    }
    
    Sleep, 1000
    
    ; Call OpenCommandPrompt
    funcCMD := DllCall("GetProcAddress", "Ptr", hModule, "AStr", "OpenCommandPrompt")
    if (funcCMD) {
        DllCall(funcCMD)
    }
    
    Sleep, 1000
    
    ; Call ShowMessageBox
    funcMsg := DllCall("GetProcAddress", "Ptr", hModule, "AStr", "ShowMessageBox")
    if (funcMsg) {
        DllCall(funcMsg)
    }
    
    ; Clean up
    DllCall("FreeLibrary", "Ptr", hModule)
} else {
    MsgBox, Failed to load DLL
}
