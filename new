"This article describes a simple yet powerful technique that attackers can use to achieve persistence by abusing Windows services.
Almost every traditional service-based attack eventually gets detected because of one thing: the service ImagePath. Whether the attacker directly modifies the ImagePath to point to malware, uses malicious command lines, or relies on DLL hijacking — all of these methods leave detectable traces in Windows event logs (such as Event ID 7045, 4697, 4624, etc.).
However, Windows services have a built-in feature called Service Recovery that is designed to help services recover automatically when they fail. Administrators can configure it to take different actions on the first failure, second failure, or subsequent failures — such as restarting the service, running a program, or even rebooting the computer. This feature exists to keep critical services running smoothly.
Attackers can abuse this same recovery mechanism for stealthy execution. There are two main ways:

Create a new service with an ImagePath that is known to crash immediately, or
Find an existing legitimate service on the target system that crashes when started (for example, UevAgentService when UE-V is disabled).

Then, the attacker modifies the recovery settings of that service to run a malicious program or command (e.g. cmd.exe with payload commands) whenever the service fails.
When the service is started (remotely), it crashes → the recovery action triggers → the attacker's program runs under SYSTEM privileges.
Why this is stealthier:
Windows logs the crash itself (Event IDs 7024, 7031, 7034), but none of these events record that a recovery program was executed or what program was launched. There is no dedicated event ID that clearly shows a recovery action took place. This makes the technique much harder to detect compared to methods that modify or expose suspicious ImagePaths."
