#SingleInstance Force

; Load and call OpenCalculator function
hModule := DllCall("LoadLibrary", "Str", "test_dll.dll", "Ptr")
if (!hModule) {
    MsgBox("Failed to load DLL: test_dll.dll")
    ExitApp(1)
}

funcAddr := DllCall("GetProcAddress", "Ptr", hModule, "AStr", "OpenCalculator", "Ptr")
if (!funcAddr) {
    MsgBox("Function 'OpenCalculator' not found in DLL")
    DllCall("FreeLibrary", "Ptr", hModule)
    ExitApp(1)
}

; Call the function
DllCall(funcAddr)
MsgBox("Calculator opened successfully!")

; Clean up
DllCall("FreeLibrary", "Ptr", hModule)
ExitApp(0)
