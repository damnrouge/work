Based on the image you've provided, it appears you are working on creating a detection and response process for remote service installs via RDP. Here's a structured response guideline that you can use to handle such incidents effectively:

---

## **Detection & Response Guidelines for Remote Service Installs via RDP**

### **Purpose**
This document outlines the steps for detecting and responding to remote service installations initiated via Remote Desktop Protocol (RDP), which may be used by attackers for persistence and lateral movement.

### **Detection Strategy**

1. **Data Source**:
   - **Windows Event Logs**:
     - Event ID 4624 (Logon Success with RDP)
     - Event ID 4697 (Service Installation)
   - **Splunk Queries**: The alert will rely on indexed logs from the `WinEventLog:Security` in Splunk.
   
2. **Query**:
   - Utilize a Splunk query similar to the one shown in the image to track remote service installations from RDP sessions. This query focuses on:
     - Successful logons using RDP (`Logon_Type=10`)
     - Matching this with service installation logs (`EventCode=4697`)
     - Filtering for specific services known to be related to persistence mechanisms (e.g., `svchost.exe`, `fspclogsvc.exe`).

3. **Indicators to Monitor**:
   - **Logon_Type**: Logon events indicating remote desktop connections (RDP).
   - **Event_Code 4697**: Windows event logs indicating the installation of a new service.
   - **Source IPs**: Correlate the source IP address to detect lateral movement within the network.
   - **Service File Names**: Monitor for unusual or unauthorized services like `fspclogsvc.exe` or other non-standard service names.

### **Response Actions**

1. **Immediate Containment**:
   - **Isolate the Host**: If the host is confirmed to have a malicious service installed via RDP, isolate it from the network to prevent further lateral movement or persistence.
   - **Terminate User Sessions**: Terminate the active user session associated with the RDP logon event to block further activities.

2. **Analysis**:
   - **Service Analysis**: Review the details of the installed service:
     - Path of the service file (`C:\Windows\System32` or other unusual directories).
     - Check if the service executable is signed or appears suspicious.
   - **Investigate Source**: Analyze the source of the RDP connection. Check if the IP address is external or belongs to a known malicious range.
   - **Account Review**: Verify if the account used for the RDP session was compromised (e.g., weak password or reused credentials).

3. **Mitigation**:
   - **Remove Unauthorized Services**: Uninstall or disable unauthorized services that were installed during the RDP session.
   - **Change Credentials**: Reset the credentials for any accounts used during the unauthorized RDP session.
   - **Patch the System**: Ensure that all relevant patches and updates are applied, particularly for vulnerabilities that allow RDP exploitation.

4. **Long-Term Remediation**:
   - **Harden RDP Access**: Implement network-level authentication (NLA) and restrict RDP access to trusted IPs.
   - **Enable Multi-Factor Authentication (MFA)**: Enforce MFA for any user accounts that have remote access permissions.
   - **Audit Service Installations**: Regularly audit the services installed on high-value servers to detect unauthorized additions.
   - **Monitor for Persistence**: Continue to monitor the environment for any persistence techniques related to service installations or unusual RDP activity.

5. **Reporting**:
   - Document the incident and response actions in your SIEM or incident management system.
   - Notify relevant stakeholders (IT, security teams) about the service installation and any potential data exfiltration or lateral movement activities.

6. **Post-Incident Review**:
   - Conduct a full investigation into how the attacker gained access to RDP and implemented a service.
   - Perform a root cause analysis to address gaps in security controls.
   - Update detection mechanisms, including Splunk queries and alerting rules, based on lessons learned.

---

This guideline should help streamline the detection and response processes for remote service installs via RDP and ensure a consistent response across your SOC team.